<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>点餐系统</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .menu { display: flex; flex-wrap: wrap; justify-content: space-around; }
        .dish-card { border: 1px solid #ddd; padding: 10px; margin: 10px; width: 200px; text-align: center; }
        .dish-image { width: 180px; height: 180px; object-fit: cover; }
        #order-list { margin-top: 20px; }
        .category { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>点餐系统</h1>
    <div id="categories">
        <!-- 菜品分类将在这里动态生成 -->
    </div>
    <div id="order-list">
        <h2>您的订单</h2>
        <!-- 订单列表将在这里动态生成 -->
    </div>
    <button onclick="placeOrder()">提交订单</button>
    <a href="orders.html">查看所有订单</a>

    <script>
        const dishes = [
            {name: "宫保鸡丁", price: 38, image: "GoT.png", category: "主菜"},
            {name: "鱼香肉丝", price: 32, image: "GoT.png", category: "主菜"},
            {name: "麻婆豆腐", price: 28, image: "GoT.png", category: "主菜"},
            {name: "可乐", price: 5, image: "GoT.png", category: "饮品"},
            {name: "雪碧", price: 5, image: "GoT.png", category: "饮品"},
            // 添加更多菜品...
        ];

        let order = [];

        function updateMenu() {
            const categories = [...new Set(dishes.map(dish => dish.category))];
            const categoryDiv = document.getElementById('categories');
            categoryDiv.innerHTML = '';
            categories.forEach(category => {
                categoryDiv.innerHTML += `<h2>${category}</h2><div class="menu" id="${category}"></div>`;
            });

            dishes.forEach(dish => {
                document.getElementById(dish.category).innerHTML += `
                    <div class="dish-card">
                        <img src="${dish.image}" alt="${dish.name}" class="dish-image">
                        <h3>${dish.name}</h3>
                        <p>价格：${dish.price}</p>
                        <button onclick="addToOrder(${dishes.indexOf(dish)})">添加到订单</button>
                    </div>
                `;
            });
        }

        function addToOrder(index) {
            order.push(dishes[index]);
            updateOrderList();
        }

        function updateOrderList() {
            const orderList = document.getElementById('order-list');
            orderList.innerHTML = '<h2>您的订单</h2>';
            order.forEach((dish, index) => {
                orderList.innerHTML += `
                    <p>${dish.name} - ${dish.price} <button onclick="removeFromOrder(${index})">删除</button></p>
                `;
            });
        }

        function removeFromOrder(index) {
            order.splice(index, 1);
            updateOrderList();
        }

        function placeOrder() {
            if (order.length > 0) {
                let orders = JSON.parse(localStorage.getItem('orders')) || [];
                const newOrder = {
                    id: Date.now(),
                    items: order,
                    total: order.reduce((sum, dish) => sum + parseFloat(dish.price), 0)
                };
                orders.push(newOrder);
                localStorage.setItem('orders', JSON.stringify(orders));

                let salesStats = JSON.parse(localStorage.getItem('salesStats')) || {};
                order.forEach(dish => {
                    if (salesStats[dish.name]) {
                        salesStats[dish.name]++;
                    } else {
                        salesStats[dish.name] = 1;
                    }
                });
                localStorage.setItem('salesStats', JSON.stringify(salesStats));

                alert('订单已提交！');
                order = [];
                updateOrderList();
            } else {
                alert('请先添加菜品到订单！');
            }
        }

        updateMenu();
    </script>
</body>
</html>
